# 前端展示專用（元資料從 manifest.json 讀取）
displayName: 分析銅庫存回補訊號
emoji: "🔔"
authorUrl: https://github.com/fatfingererr/macro-skills

tools:
  - claude-code

featured: false
installCount: 0

testQuestions:
  - question: '當前銅庫存回補訊號狀態如何？'
    expectedResult: |
      # 銅：庫存回補訊號（SHFE / COMEX）

      ## 最新狀態
      - 數據日期：YYYY-MM-DD
      - SHFE 庫存：XXX,XXX 噸
      - SHFE 4 週回補速度 z-score：+X.X
      - COMEX 庫存：XX,XXX 噸
      - COMEX 4 週回補速度 z-score：+X.X
      - 總庫存（SHFE + COMEX）：XXX,XXX 噸
      - 銅期貨價格：X.XX USD/lb

      ## 短期判斷
      - 訊號：**CAUTION / NEUTRAL / SUPPORTIVE**
      - 原因：根據 SHFE 庫存水位與回補速度判定
      - 歷史驗證：過去同類訊號命中率約 XX%

      ## 長期判斷
      - 銅價 10 年歷史分位數：0.XX
      - 結論：**CHEAP / FAIR / RICH**

  - question: 'SHFE 庫存快速回補是否預示價格短線高點？'
    expectedResult: |
      歷史驗證分析結果：

      當 SHFE 銅庫存同時滿足：
      1. 回補速度 z-score > 1.5（異常快）
      2. 庫存水位 > 85% 分位數（偏高）

      過去該訊號觸發後 ±2 週內對應價格局部高點的命中率約 **60-65%**。

      COMEX 庫存作為輔助驗證：
      - 若 COMEX 同步回補，訊號強度增加
      - 若 COMEX 去庫存，可能為區域性調倉而非真正需求變化

      這代表：
      - 訊號有一定參考價值，但非 100% 準確
      - 短線謹慎態度是合理的，但不是做空依據
      - 長期趨勢仍需結合基本面判斷

  - question: '銅價目前是長期偏便宜還是偏貴？'
    expectedResult: |
      銅價長期分位數分析：

      計算方法：銅價（HG=F）在過去 10 年（520 週）的分位數排名

      判讀標準：
      - 分位數 ≤ 0.35 → **長期偏便宜**
      - 0.35 < 分位數 < 0.65 → **長期中性**
      - 分位數 ≥ 0.65 → **長期偏貴**

      當前判讀：根據最新數據計算

  - question: 'SHFE 和 COMEX 庫存走勢是否同步？'
    expectedResult: |
      庫存同步性分析：

      **同步情境**（兩者同向變動）：
      - 反映全球銅需求的真實變化
      - 訊號可信度較高

      **背離情境**（兩者反向變動）：
      - 可能為區域性套利或調倉
      - 需謹慎解讀單一庫存訊號
      - 關注價差（SHFE-COMEX）變化

      當前狀態：根據最新 z-score 判定

qualityScore:
  overall: 70
  badge: 白銀
  evaluatedAt: "2026-01-26"

  metrics:
    problemFit: 80
    correctness: 70
    dataGovernance: 70
    robustness: 65
    maintainability: 65
    usability: 75

  metricDetails:
    problemFit:
      score: 80
      strengths:
        - 雙層訊號框架清晰對應短期/長期判讀
        - 將主觀「快速回補」轉化為 z-score 量化
        - 整合 SHFE 和 COMEX 雙庫存來源
        - 包含歷史驗證增加說服力
      improvements:
        - 可增加 LME 庫存形成三大交易所完整視圖
        - 可增加季節性調整

    correctness:
      score: 70
      strengths:
        - z-score 計算方法明確
        - 分位數計算邏輯清晰
        - 包含回測驗證機制
        - SHFE/COMEX 分別計算後加總
      improvements:
        - 需增加 examples/ golden case
        - 需驗證不同 z-score 門檻的影響

    dataGovernance:
      score: 70
      strengths:
        - MacroMicro CDP 抓取流程成熟
        - Yahoo Finance 作為價格來源穩定
        - 三類數據統一管理
      improvements:
        - 需增加 fallback 數據源
        - 需增加數據版本追蹤

    robustness:
      score: 65
      strengths:
        - 有快取機制避免重複請求
        - 基本錯誤處理
        - 單一數據源失效時仍可運作
      improvements:
        - 需增加缺值處理策略
        - 需增加 failure-modes.md

    maintainability:
      score: 65
      strengths:
        - Router pattern 設計
        - 參數定義完整
        - 統一數據抓取腳本
      improvements:
        - 需增加單元測試
        - 需增加版本更新日誌

    usability:
      score: 75
      strengths:
        - 輸出包含 TL;DR 與依據
        - 雙層訊號易於理解
        - 包含歷史命中率
        - 同時顯示 SHFE 和 COMEX 狀態
      improvements:
        - 可增加更多歷史事件對照
        - 可增加警報通知機制

  details: |
    **任務適配度（80/100）**
    - 雙層訊號框架清晰
    - z-score 量化主觀判斷
    - 已整合 SHFE 和 COMEX 雙庫存

    **正確性（70/100）**
    - 計算方法明確
    - 包含回測驗證
    - 待改進：增加 golden case

    **資料治理（70/100）**
    - CDP 抓取流程成熟
    - 三類數據統一管理
    - 待改進：增加 fallback 數據源

    **穩健性（65/100）**
    - 有基本快取機制
    - 待改進：增加 failure-modes.md

    **可維護性（65/100）**
    - Router pattern 設計
    - 待改進：增加單元測試

    **輸出可用性（75/100）**
    - TL;DR 與依據完整
    - 雙庫存狀態清晰呈現
    - 待改進：增加歷史對照

  upgradeNotes:
    targetBadge: 黃金
    requirements:
      - metric: robustness
        currentScore: 65
        targetScore: 75
        suggestion: 增加 failure-modes.md 與缺值處理
      - metric: correctness
        currentScore: 70
        targetScore: 80
        suggestion: 增加 examples/ golden case

bestPractices:
  - title: 雙層判讀
    description: 短期訊號與長期分位數應分開解讀，短期謹慎不代表長期看空
  - title: 雙庫存驗證
    description: SHFE 為主要訊號源，COMEX 作為輔助驗證，兩者同向時訊號更可靠
  - title: z-score 門檻
    description: 1.5 為常用門檻，可根據市場波動調整至 1.2-2.0
  - title: 滾動窗口
    description: 使用 3 年滾動計算 z-score 基準，避免遠期數據過度影響
  - title: 週頻對齊
    description: SHFE 庫存為週數據，COMEX 和價格統一轉換為週頻後再分析
  - title: 總庫存觀察
    description: 關注 SHFE + COMEX 總庫存變化，反映全球可見庫存趨勢

pitfalls:
  - title: 訊號過度依賴
    description: 將庫存訊號視為唯一決策依據
    consequence: 忽略基本面、政策面等其他因素，導致錯誤判斷
  - title: 忽略季節性
    description: 不考慮農曆新年前後的季節性庫存波動
    consequence: 誤將季節性回補視為異常訊號
  - title: 短線與長線混淆
    description: 用短期訊號推導長期趨勢
    consequence: 短線 CAUTION 不代表長期看空
  - title: 忽略庫存背離
    description: 只看單一庫存來源，忽略 SHFE 與 COMEX 的背離
    consequence: 誤將區域性調倉視為全球需求變化
  - title: 價格數據換倉跳躍
    description: 期貨連續合約（HG=F）在換倉日可能有價格跳躍
    consequence: 可能影響短期 z-score 計算

faq:
  - question: 為什麼同時使用 SHFE 和 COMEX 庫存？
    answer: |
      **SHFE（上海期貨交易所）**：
      - 反映中國銅需求的即時變化
      - 中國消費全球約 50% 的精煉銅
      - 作為**主要訊號來源**

      **COMEX（芝加哥商品交易所）**：
      - 反映北美/西方市場庫存
      - 作為**輔助驗證來源**
      - 與 SHFE 同步時，訊號更可靠

      **總庫存（SHFE + COMEX）**：
      - 反映全球可見庫存趨勢
      - 用於判斷整體供需格局

  - question: SHFE 和 COMEX 庫存背離時如何解讀？
    answer: |
      **背離情境**（兩者反向變動）：

      1. **SHFE 回補 + COMEX 去庫存**：
         - 可能為中國進口增加導致庫存轉移
         - 關注進口數據與價差變化

      2. **SHFE 去庫存 + COMEX 回補**：
         - 可能為中國出口增加或需求減弱
         - 需觀察是否為季節性因素

      **建議**：
      - 背離時降低訊號權重
      - 搭配價差（SHFE-COMEX）分析
      - 關注實物流向數據

  - question: 銅價數據來源為何選擇 Yahoo Finance？
    answer: |
      **選擇 Yahoo Finance (HG=F) 的原因**：

      1. **免費且穩定**：無需付費訂閱
      2. **API 友好**：透過 yfinance 套件輕鬆取得
      3. **連續合約**：自動處理換倉，無需手動拼接

      **注意事項**：
      - HG=F 為 COMEX 銅期貨連續近月合約
      - 換倉日可能有價格跳躍
      - 建議使用週收盤價減少噪音

  - question: z-score 為什麼用 3 年滾動而非全歷史？
    answer: |
      庫存行為會隨市場結構變化而改變（如期貨持倉規模、套利策略）。

      3 年滾動可以：
      1. 捕捉近期市場特性
      2. 避免遠期極端值干擾
      3. 保持足夠樣本量（~156 週）

      SHFE 和 COMEX 各自計算 z-score，保持獨立的基準線。

  - question: 歷史命中率 60% 是否有統計意義？
    answer: |
      60% 命中率代表訊號比隨機猜測（50%）略好，
      但不足以作為唯一交易依據。

      正確用法：
      - 作為風險管理參考（謹慎而非做空）
      - 搭配其他指標交叉驗證
      - 關注命中率的時間變化（近期是否失效）
      - SHFE 和 COMEX 同步觸發時，提高訊號權重

  - question: 三類數據的更新頻率為何？
    answer: |
      | 數據 | 來源 | 更新頻率 | 建議抓取時機 |
      |------|------|----------|--------------|
      | SHFE 庫存 | MacroMicro | 週 | 每週一 |
      | COMEX 庫存 | MacroMicro | 日 | 每日 |
      | 銅期貨價格 | Yahoo Finance | 日 | 每日 |

      **快取策略**：12 小時有效期，週內多次執行會使用快取。

about:
  repository: https://github.com/fatfingererr/macro-skills
  branch: main
  additionalInfo: |
    ## 設計背景

    此技能源於市場常見敘事：「SHFE 庫存快速回補 → 短線價格可能見頂」。

    本 Skill 將這個主觀判讀轉化為：
    1. **可量化**：回補速度 z-score（SHFE 和 COMEX 分別計算）
    2. **可回測**：歷史訊號命中率
    3. **可自動更新**：透過 CDP 自動抓取最新數據
    4. **多源驗證**：SHFE 主訊號 + COMEX 輔助驗證

    ## 數據來源

    | 數據 | 來源 | 用途 |
    |------|------|------|
    | SHFE 銅庫存 | MacroMicro (CDP) | 主要訊號源 |
    | COMEX 銅庫存 | MacroMicro (CDP) | 輔助驗證 |
    | 銅期貨價格 | Yahoo Finance (HG=F) | 長期分位數判讀 |

    ## 使用場景

    - 交易員評估短線風險水平
    - 分析師驗證市場流行敘事
    - 投資者判斷進場時機（短線謹慎 vs 長線價值）
    - 觀察 SHFE 與 COMEX 庫存同步性
